\documentclass[main.tex]{subfiles}

\begin{document}
In section 2, we saw that all type families were fibrations and what that means specifically in HoTT. Of course in sHoTT type families are also fibrations, with respect to \textit{paths} that is. The question of which type families are fibrations with respect to \textit{morphisms} and \textit{higher morphisms}, is not as trivial in sHoTT. In this section, we define and characterize type families that lift morphisms. Before we can define such type families, we must first make precise what it means to be a "morphism in the total space".
\begin{definition}
Given a type $A$, a type family $C : A \to \U$, points $x,y : A$, a morphism $f : \ho[A]{x}{y}$ and points $u : C(x)$ and $v : C(y)$, the type of \textbf{dependent morphisms over} $f$ \textbf{from} $u$ to $v$ is written as $$
\dho{C}{f}{u}{v} \defeq \exten{t : \osx}{C(f(t))}{\pardo}{[u,v]}.$$
\end{definition}
The dependent morphism represents the intuitive notion of "morphism in the total space". Alternatively, we can observe that a type family $C: A \to \U$ associates morphisms $f : \ho[A]{x}{y}$ to spans
% https://q.uiver.app/#q=WzAsMyxbMSwwLCJcXHNte3U6Qyh4KX17djpDKHkpfVxcZGhve0N9e2Z9e3V9e3Z9Il0sWzAsMSwiQyh4KSJdLFsyLDEsIkMoeSkiXSxbMCwxLCJcXGRvbSIsMl0sWzAsMiwiXFxjb2QiXV0=
\[\begin{tikzcd}
	& {\sm{u:C(x)}{v:C(y)}\dho{C}{f}{u}{v}} \\
	{C(x)} && {C(y)}
	\arrow["\dom"', from=1-2, to=2-1]
	\arrow["\cod", from=1-2, to=2-3]
\end{tikzcd}\]
We do not know a priori that $C$ depends functorially on $A$. We cannot even assert that \textit{spans} depend functorially on $A$ either, given 
\begin{definition}
    Given a type $A$ and
    \begin{gather*}
                          x,y,z : A  \\
    f : \ho[A]{x}{y} \qquad g : \ho[A]{y}{z} \qquad h:\ho[A]{x}{z} \\
    t : \homtwo{A}(x,y,z,f,g,h)\\
    u : C(x) \qquad v : C(y) \qquad w : C(z) \\
    p : \dho{C}{f}{u}{v} \qquad q : \dho{C}{g}{v}{w} \qquad r : \dho{C}{h}{u}{w}
    \end{gather*}
    we define
    $$\homtwo{C(t)}(u,v,w,p,q,r) \defeq \exten{s : \tsx}{C(t(s))}{\pardt}{[u,v,w,p,q,r]}$$
    and say that a morphism in $\homtwo{C(t)}(u,v,w,p,q,r)$ is a \textbf{dependent 2-simplex over} $t$.
\end{definition}
In the case that $g \circ f = h$, we cannot necessarily conclude that the span associated to $C(h)$ is equal to the composites of the spans $C(g)$ and $C(f)$. These issues have easy workarounds, we can restrict ourselves to type families that act as fibrations with respect to morphisms, or alternatively functorial with respects to the fibers of $C$. 
\begin{definition}
A type family is \textbf{covariant} if for every $f : \ho[A]{x}{y}$  and $u : C(x)$, the type $$\sm{v : C(y)} \dho{C}{f}{u}{v}$$
is contractible. When the context is clear, we write the specific inhabitant as $(f_*u, \trans{f}{u}).$

Dually\footnote{We will not explicitly state dual theorems and definitions when they are obvious from context.}, $C$ is \textbf{contravariant} if for every $f : \ho[A]{x}{y}$  and $v : C(y)$, the type $$\sm{v : C(x)} \dho{C}{f}{u}{v}$$
is contractible.
\end{definition}
We can also show that definition of a covariant type family really does correspond to the familiar notion of a fibration in topology:
\begin{lemma}
    A type family $C : A \to \U$ is covariant if and only if for all morphisms $f : \ho[A]{x}{y}$ and points $u : C(x)$ the type $\exten{t : \osx}{C(f(t))}{0}{u}$ is contractible; there is a unique lifting of $f$ that starts at $u$.
\end{lemma}

Often times, we are in a situation where we are given a covariant family with a Segal base. In such cases, a very useful property applies

\begin{lemma}[RS17 Thm 8.8]
    If $A$ is segal and $C : A \to \U$ is covariant, then 
    $$\sm{a : A}C(a)$$
    is Segal.
\end{lemma}

Like in category theory, we can make extensive use of the covariance of the "representable" $\lam{x} \ho[A]{a}{x}$. 
To start, we see that the covariant of the representable allows us to characterize Segal types.

\begin{lemma}[RS17 Prop 8.13]
    Given a type $A$ and a point $a : A$, then
    $$\lam{x} \ho[A]{a}{x} : A \to \uc$$  if and only if $A$ is Segal.
\end{lemma}
We can also show that dependent morphisms are equivalent to a path whose domain is a transport, analogous to the situation in HoTT.

\begin{lemma}[RS17 Lem 8.15]
    If $C : A \to \U$ is covariant, $f : \ho[A]{x}{y}$, $u: C(x)$, and $v : C(y)$, then
    $$\ho[C(f)]{u}{v} \simeq (f_*u =_{C(y)}v).$$
\end{lemma}

For covariant families with Segal bases, we can show that "directed transporting" is functorial:
\begin{lemma}[RS17 Prop 8.16]
    For any segal type $A$, covariant family $C : A \to \U$, $f : \ho[A]{x}{y}$, $g : \ho[A]{y}{z}$, and $u : C(X)$, we have
    \begin{gather*}
        g_*(f_*\,u) = (g\cdot f)_*\,u \qquad \normalfont \text{ and } \qquad (\idhom{x})_*\,u = u
    \end{gather*}
\end{lemma}

Naturality also comes for free, for maps between covariant types.

\begin{lemma}[RS17 Prop 8.17]
    For any two covariant families $C,D : A \to \U$ and a fiberwise map $\phi : \prd{x : A}C(x) \to D(x)$, $f: \ho[A]{x}{y}$ and $u:C(x)$,
    $$\phi_y(f_*\,u) = f_*(\phi_x(u)).$$
\end{lemma}

We can also show that covariant types over Segal bases have discrete fibers.

\begin{lemma}[RS17 Prop 8.18]
    For any Segal type $A$ and covariant map $C : A \to \U$, and $x : A$, the type $C(x)$ is discrete.
\end{lemma}

\begin{lemma}[RS17 Cor 8.19]
    If $A$ is Segal, then for any $x,y: A$ the type $\ho[A]{x}{y}$ is discrete.
\end{lemma}

\begin{lemma}[RS17 Cor 8.20]
    If $A$ is discrete, then for any $x,y : A$, so is $x =_A y$.
\end{lemma}
We also enjoy some closure properties with covariant type families: mapping into a covariant family is covariant and mapping out of a covariant family \textit{into a discrete tpye} is contravariant.

\begin{lemma}[RS17 Prop 8.30]
    \label{lem:covcodiscov}
    For types $C$, $A$, and covariant family $B : C \to \U$, the type family $$\lam{x : C} A \to B(x) : C \to \U$$
    is also covariant.
\end{lemma}

\begin{lemma}[RS17 Prop 8.31]
    \label{lem:covdomiscon}
    For a discrete type $Y$ and a covariant type family $C : A \to \U$, the type
    $$\lam{x : A}C(a) \to Y$$
    is contravariant.
\end{lemma}

Transporting a sigma of covariant types is the same as transporting in each individual component.
\begin{lemma}
    \label{lem:tptinsigma}
     For any covariant type families $P : A \to \U$, $Q : \prd{x : A}P(x) \to \U$, a morphism $f : \ho[A]{x}{y}$, point $p : P(x)$, and map 
     $\phi : \prd{p : P(x)}Q(x,p)$,
    $$(f_*(p),(f_* \circ \phi)(p)) = f_* (p, \phi(p))$$
\end{lemma}
    



In HoTT, we saw that type families were automatically fibrations. We hope to see the same in sHoTT, but it is not true that all families are fibrations.
We can instead axiomatize some classifier universe for covariant fibrations, that can only be used in a particular way.
\begin{axiom}
    There is a Segal universe of discrete types $\uc$ along with an encoding function 
    $$\co : \prd{A : \U}{B : A \to \U}(\isc\, A\, B) \to (A \to \uc)$$
    and decoding function
    $$\text{El} : \prd{A : \U}(A \to \uc) \to (A \to \U)$$
    with, for every type $A$, family $B : A \to \U$ and proof that $c$, a proof that $B$ is covariant, a retraction 
    $$\text{El}\,A\,(\co\, A\, B\, c) = B$$
\end{axiom}
\begin{remark}
    Fibers of covariant types are discrete, so discrete types are the points of $\uc$. This is especially reasonable if you observe
    that discrete types over $\Un$ are covariant. 
\end{remark}


\end{document}