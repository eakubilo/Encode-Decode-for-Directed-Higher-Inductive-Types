\documentclass[main.tex]{subfiles}

\begin{document}
With our three-layer type theory and extension types, we can start to define familiar category theoretic notions. We start by defining important types which depend on shapes.

\begin{definition}
    For a type $A$ and points $x,y : A$ which induce a term $[x,y]$\footnote{Spelled out, this is a term that depends on $t : \pardo $ that evaluates to $x$ when $t \equiv 0$ and $y$ when $t \equiv 1$.} in context $\pardo$, we write
    $$\ho[A]{x}{y} \defeq \ndexten{\osx}{A}{\pardo}{[x,y]}$$
    and say that an element of $\ho[A]{x}{y}$ is a \textbf{morphism} from $x$ to $y$. 
\end{definition}
\begin{definition}
    For points $x,y,z : A$, and morphisms $f : \ho[A]{x}{y}$, $g : \ho[A]{y}{z}$, and $h : \ho[A]{x}{z}$ which induces a term $[x,y,z,f,g,h]$\footnote{Similarly, this is a term that depends on $\pair{t}{s} :\pardt$ that evaluates to:
    \begin{itemize}
        \item $x$ when $\pair{t}{s} \equiv \pair{0}{0}$ 
        \item $y$ when $\pair{t}{s} \equiv \pair{1}{0}$ 
        \item $z$ when $\pair{t}{s} \equiv \pair{1}{1}$
        \item $f$ when $\pair{t}{s} \equiv \pair{t}{0}$
        \item $g$ when $\pair{t}{s} \equiv \pair{1}{s}$
        \item $h$ when $\pair{t}{s} \equiv \pair{t}{t}$
    \end{itemize} } in context $\pardt$, we write
    $$\homtwo{A}(x,y,z,f,f,h) \defeq \ndexten{\tsx}{A}{\pardt}{[x,y,z,f,g,h]}$$
    or, in an abbreviated fashion,
    $$\homtwoshort{A}(x,y,z,f,g,h)$$
    and say that an element of $\homtwoshort{A}(x,y,z,f,g,h)$ is a $2$-\textbf{morphism}.
\end{definition}


Not only do functions act functorially on paths, they also act functorially on morphisms and higher morphisms. That is, functions
are \textit{functors}.
\begin{lemma}(Morphism application)
    Let $A,B$ be types and $f : A \to B$. Then, given $x,y : A$, there are functions 
    $$\mapfunc{f} : \ho[A]{x}{y} \to \ho[A]{f x}{f y}$$
\end{lemma}

In section 2, we saw that composition of paths was a function. This does not analogously hold automatically for morphisms. In sHoTT,
the slogan is "some types are infinity categories" and this is the first place we see why that may be. Instead of types automatically
coming with the structure of an infinity category and more specifically, that have a compoisition of morphisms operation, we must
restrict our study to such types. Thus, we can ask for types whose morphisms do have composites. For a programming languages analogy, 
composition of paths is a parametrically polymorphic function while composition of morphisms is a type class polymorphic function.
That leads us to the following definition.
\begin{definition}\label{def:def3.3}
    Let $A$ be a type, $x,y,z : A$ and $f : \ho[A]{x}{y}$ and $g : \ho[A]{y}{z}$. We say $A$ is \textbf{Segal} if the type $${\sm{h : \ho[A]{x}{z}} \hot[A]{f}{g}{h}} $$
    is contractible. The unique inhabitant is denoted by $(g\cdot f, \comp{g}{f}).$
\end{definition}

In other words two composable morphisms are enough to specify a 2-morphism in a Segal type. That leads us to the following important alternative characterization of Segal-ness.

\begin{lemma}
A type $A$ is Segal if and only if the restriction map
$$
(\tsx \to A) \to (\tohorn \to A) 
$$
is an equivalence. 
\end{lemma}
\begin{remark}
    In the proof of (lemma reference), c.f proves along the way that there is an equivalence
    \begin{equation}
        \sm{h : \ho[A]{x}{z}}\homtwo{A}(x,y,z,f,g,h) \simeq \ndexten{\tsx}{A}{\tohorn}{[x,y,z,f,g]}.
    \end{equation}

    \noindent The same argument applies to form equivalences 

    \begin{equation}
        \label{rem:sumoverfistt}
    \sm{f : \ho[A]{x}{y}}\homtwo{A}(x,y,z,f,g,h) \simeq \ndexten{\tsx}{A}{\tthorn}{[x,y,z,g,h]}
    \end{equation}
    and
    \begin{equation}
    \sm{g : \ho[A]{y}{z}}\homtwo{A}(x,y,z,f,g,h) \simeq \ndexten{\tsx}{A}{\tzhorn}{[x,y,z,f,h]}.
    \end{equation}
\end{remark}
Paths between morphisms also correspond two 2-morphisms:
\begin{lemma}
    \label{lem:pathis2mor}
    For any $f,g : \ho[A]{x}{y}$ in a Segal type $A$, the natural map
    $$f = g \to \homtwo{A}(x,y,z, \idhom{x}, f,g)$$
    is an equivalence.
\end{lemma}
\begin{lemma}
    \label{lem:compequalis2mor}
    For any $f: \ho[A]{x}{y}$, $g : \ho[A]{y}{z}$, and $h : \ho[A]{x}{z}$ in a Segal type $A$, the natural map
    $$g \cdot f = h \to \homtwo{A}(x,y,z,f,g,h)$$
    is an equivalence.
\end{lemma}
We can take this one step further:
\begin{lemma}
    \label{lem:compissquare}
    For any Segal type $A$ and morphisms $f : \ho[A]{a}{c}$, $g:\ho[A]{b}{d}$, $p:\ho[A]{a}{b}$, and $q : \ho[A]{c}{d}$,
    \begin{equation}
        \ho[{(\lam{(x,y)}\ho[A]{x}{y})(\lam{i}(pi,qi))}]{f}{g} \simeq g \cdot p = q \cdot f
    \end{equation}
\end{lemma}
\begin{proof}
By lemma~\ref{lem:exten_curry},
\begin{equation*}
    \ho[{(\lam{(x,y)}\ho[A]{x}{y})(\lam{i}(pi,qi))}]{f}{g} \simeq \ndexten{\mathbbm{2}\times\mathbbm{2}}{A}{\partial \square}{[f,q,p,g]}
\end{equation*}
where $\square$ is the square boundary
\[
  \begin{tikzcd} 
        a \arrow[r, "f"] \arrow[d, "p"']   
        & c \arrow[d, "q"] 
         \\ 
        b \arrow[r, "g"']  & d
    \end{tikzcd} 
\]
Since $\mathbbm{2}\times\mathbbm{2}$ is the pushout of two copies of $\tsx$ along the diagonal faces, we can push our equivalence to the type
\begin{equation*}
    \sm{h : \ho[A]{a}{d}}\left( \homtwo{A}(a,c,d,f,q,h) \times \homtwo{A}(a,b,d,p,g,h)\right)
\end{equation*}
By lemma~\ref{lem:sigisassoc}, this is equivalent to
\begin{equation*}
    \sm{(h, t) : \sm{h:\ho[A]{a}{d}}\homtwo{A}(a,c,d,f,q,h) } \homtwo{A}(a,b,d,p,g,h).
\end{equation*}
Lemma~\ref{contractibleissimple} allows us to contract the base to give
\begin{equation}
    \homtwo{A}(a,b,d,p,g,q\cdot f),
\end{equation}
which by lemma~\ref{compequalis2mor} is equivalent to
\begin{equation}
    g \cdot p = q \cdot f
\end{equation}
\end{proof}
\end{document}