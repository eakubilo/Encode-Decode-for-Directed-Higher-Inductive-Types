\documentclass[main.tex]{subfiles}

\begin{document}
We can also define the \textbf{direted circle}, similarly known as the \textbf{simplicial circle}, and show that its fundamental
monoid is the natural numbers.

Let $S$ be the \textit{Segal} type generated by the constructors
\begin{itemize}
    \item $\ba : S$
    \item $\dl : \ho[S]{\ba}{\ba}$
\end{itemize}
The recursion principle for $S$ states that for any Segal type $B$ along with
\begin{itemize}
    \item a point b : B
    \item a morphism $l : \ho[B]{b}{b}$
\end{itemize}
there is a function $f : S \to B$ such that $f(\ba) \equiv b$ and $f(\dl) = l$.

The induction principle for $S$ states that for any inner type family $C : S \to \U$ along with 
\begin{itemize}
    \item a point $c : C(\ba)$
    \item a dependent morphism $l : \ho[C(\dl)]{c}{c}$
\end{itemize}
there is a function $f : \prd{x:S}C(x)$ such that $f(\ba) \equiv c$ and $f(\dl) = l$.

We start by defining a function $\co : S \to \uc$ with the defining equations
\begin{align*}
    &\co\,\ba \defeq \Nd\\
    &\co\,\dl \defeq \, \dua(\su)
\end{align*}

We can define $\eco : \prd{x : S}\ho[S]{\ba}{x} \to \co\,x$ as 
\begin{align*}
    \eco = \yon{\co}{\ba}(0)
\end{align*}
Before we can define decode, we define a map $f : \Nd \to \ho[S]{\ba}{\ba}$ as 
\begin{align*}
    f(0) \defeq \idhom{\ba}\\
    f(\su(n)) \defeq \dl \cdot f(n)
\end{align*}
This allows us to define the point constructor of $\dco : \prd{x:S}\co\,x \to \ho[S]{\ba}{x}$ with the following definition 
\[
\dco \, \ba \defeq f
\]
To define $\dco(\dl)$, we need to supply a term of type 
\[
\dua(f) \cdot \dua(\su) = \ho[s]{\ba}{\dl} \cdot \dua(f),
\]
which is equivalent to the type 
\[
f \circ \su = \dl_* \circ f 
\]
For all $n : \mathbb{N}$, we have that $(f \circ \su)(n) \equiv \dl \cdot f(n)$ and $(\dl_* \circ f )(n) \equiv \dl \cdot f(n)$. Thus,
it suffices to supply $\refl{}$. With $\eco$ and $\dco$ defined, it is time to show they are quasi-inverses.

\begin{lemma}
    There is a map 
    $$ \eta : \prd{x : S}{f : \ho[S]{\ba}{x}} \dco \, x (\eco \, x f) = f$$
\end{lemma}
\begin{proof}
By the dependent yoneda lemma, it suffices to provide a term of the type
$$\dco \, \ba (\eco \, \ba\,\idhom{\ba}) = \idhom{\ba}.$$

Note, though, that $\eco$ was defined using the Yoneda lemma, hence it is a natural transformation that sends $\idhom{\ba}$ to $0$. So, our equality becomes $$
\dco \, \ba \, 0 = \idhom{\ba}.$$ We know how $\dco$ acts on these inputs, so it suffices to provide a term of the type
$$\idhom{\ba} = \idhom{\ba}$$
of which $\refl{\idhom{\ba}}$ suffices.
\end{proof}

\begin{lemma}
    There is a map 
    $$ \epsilon : \prd{x : S}{u : \co\,x} \eco \, x (\dco \, x u) = u$$
\end{lemma}
\begin{proof}
We can leverage the induction principle to define this map. So, in the context of $x : S$, it suffices to first consider 
$x \equiv \ba$. In that case, we can use natural number induction and it suffices to consider $u \equiv 0$ first. In that case,
we note that 
$$\eco \, \ba \, (\dco \, \ba 0) = 0 \equiv 0 = 0$$
So, we simply supply $\refl{}$. When $u \equiv \su(n)$, we note the following chain of paths:
\begin{align*}
    \eco \, \ba (\dco \, \ba\, \su(n)) \equiv \\
    \eco \, \ba (\dl \cdot (\dco \, \ba\, n)) \equiv \\
    \eco \, \ba (\dl_* (\dco \, \ba \,n)) = \\
    \dl_*(\eco \, \ba (\dco \, \ba \,n)) = \\
    \dl_*(n) =\\
    \su(n)
\end{align*}
The concatenation inhabits $\eco \, \ba (\dco \, \ba\, \su(n)) = \su(n)$, as desired.

Now all is left is to show our lemma for $x \equiv \dl$. Let $$\phi : \prd{n:\Nd}\eco\,\ba\,(\dco\,\ba\,n) = n$$ be the map we just defined. 
We seek to show that $$\dl_* \circ \phi = \phi \circ \dl_*.$$
Let $n : \Nd$. Also, let $C(n) \defeq  \eco\,\ba\,(\dco\,\ba\,n)=n $.  Then, 
$$(\phi(\dl_*(n)), \lam{t}\phi(\trans{\dl}{n}t)):\sm{v : C(\su(n))}\ho[C(\dl)]{\phi}{v}$$
and similarly 
$$(\dl_*(\phi(n)), \trans{f}{\phi(n)}):\sm{v : C(\su(n))}\ho[C(\dl)]{\phi}{v}$$
So by contractibility, $\phi(\dl_*(n)) = \dl_*(\phi(n))$, which implies $\dl_* \circ \phi = \phi \circ \dl_*$ by function extensionality.
\end{proof}
Thus, we have shown that the fundamental monoid of the simplicial circle is $\Nd$.


\end{document}